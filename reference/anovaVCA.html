<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>ANOVA-Type Estimation of Variance Components for Random Models — anovaVCA • mcradds</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="ANOVA-Type Estimation of Variance Components for Random Models — anovaVCA"><meta name="description" content="
A copy from VCA::anovaVCA in VCA package"><meta property="og:description" content="
A copy from VCA::anovaVCA in VCA package"><meta property="og:image" content="https://kaigu1990.github.io/mcradds/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mcradds</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/mcradds.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/kaigu1990/mcradds/"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>ANOVA-Type Estimation of Variance Components for Random Models</h1>
      <small class="dont-index">Source: <a href="https://github.com/kaigu1990/mcradds/blob/main/R/vca.R" class="external-link"><code>R/vca.R</code></a></small>
      <div class="d-none name"><code>anovaVCA.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a></p>
<p>A copy from <a href="https://rdrr.io/pkg/VCA/man/anovaVCA.html" class="external-link">VCA::anovaVCA</a> in <code>VCA</code> package</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">anovaVCA</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments passed on to <code><a href="https://rdrr.io/pkg/VCA/man/anovaVCA.html" class="external-link">VCA::anovaVCA</a></code></p><dl><dt><code>form</code></dt>
<dd><p>(formula) specifying the model to be fit, a response variable left of the '~' is mandatory</p></dd>

    <dt><code>Data</code></dt>
<dd><p>(data.frame) containing all variables referenced in 'form'</p></dd>

    <dt><code>by</code></dt>
<dd><p>(factor, character) variable specifying groups for which the analysis should be performed individually,
i.e. by-processing</p></dd>

    <dt><code>NegVC</code></dt>
<dd><p>(logical) FALSE = negative variance component estimates (VC) will be set to 0 and they will not contribute to the total variance
(as done in SAS PROC NESTED, conservative estimate of total variance). The original ANOVA estimates can be found in element 'VCoriginal'.
The degrees of freedom of the total variance are based on adapted mean squares (MS), i.e. adapted MS are computed as \(D * VC\), where VC is
the column vector with negative VCs set to 0. <br>
TRUE = negative variance component estimates will not be set to 0 and they will contribute to the total variance (original definition of the total variance).</p></dd>

    <dt><code>VarVC.method</code></dt>
<dd><p>(character) string specifying whether to use the algorithm given in Searle et al. (1992) which corresponds to <code>VarVC.method="scm"</code> or in
Giesbrecht and Burns (1985) which can be specified via "gb". Method "scm" (Searle, Casella, McCulloch)
is the exact algorithm, "gb" (Giesbrecht, Burns) is termed "rough approximation"
by the authors, but sufficiently exact compared to e.g. SAS PROC MIXED (method=type1) which
uses the inverse of the Fisher-Information matrix as approximation. For balanced designs all
methods give identical results, only in unbalanced designs differences occur.</p></dd>

    <dt><code>MME</code></dt>
<dd><p>(logical) TRUE = (M)ixed (M)odel (E)quations will be solved, i.e. 'VCA' object will have additional elements
"RandomEffects", "FixedEffects", "VarFixed" (variance-covariance matrix of fixed effects) and the "Matrices"
element has addional elements corresponding to intermediate results of solving MMEs.
FALSE = do not solve MMEs, which reduces the computation time for very complex models significantly.</p></dd>

    <dt><code>quiet</code></dt>
<dd><p>(logical) TRUE = will suppress any warning, which will be issued otherwise</p></dd>

    <dt><code>order.data</code></dt>
<dd><p>(logical) TRUE = class-variables will be ordered increasingly, FALSE = ordering of class-variables
will remain as is</p></dd>


</dl></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a class of <code>VCA</code> for downstream analysis.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/VCA/man/anovaVCA.html" class="external-link">VCA::anovaVCA()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">glucose</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">anovaVCA</span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="va">day</span> <span class="op">/</span> <span class="va">run</span>, <span class="va">glucose</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Result Variance Component Analysis:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Name    DF       SS    MS        VC        %Total    SD       CV[%]   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 total   64.77732                 12.933553 100       3.596325 1.472697</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 day     19       415.8 21.884211 1.958553  15.143191 1.399483 0.573089</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 day:run 20       281   14.05     3.075     23.77537  1.753568 0.718087</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 error   40       316   7.9       7.9       61.081439 2.810694 1.15098 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean: 244.2 (N = 80) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Experimental Design: balanced  |  Method: ANOVA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kai Gu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

