<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="mcradds">
<title>Introduction to mcradds • mcradds</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to mcradds">
<meta property="og:description" content="mcradds">
<meta property="og:image" content="https://kaigu1990.github.io/mcradds/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mcradds</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/mcradds.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/kaigu1990/mcradds/">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to mcradds</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/kaigu1990/mcradds/blob/HEAD/vignettes/mcradds.Rmd" class="external-link"><code>vignettes/mcradds.Rmd</code></a></small>
      <div class="d-none name"><code>mcradds.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr>
<p>This vignette shows the general purpose and usage of the
<code>mcradds</code> R package.</p>
<p><code>mcradds</code> is a successor of the <code>mcr</code> R package
that is developed by Roche, and therefore the fundamental coding ideas
for method comparison regression have been borrowed from it. In
addition, I supplement a series of useful functions and methods based on
several reference documents from CLSI and NMPA guidance. You can perform
the statistical analysis and graphics in different IVD trials utilizing
these analytical functions.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/browseVignettes.html" class="external-link">browseVignettes</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"mcradds"</span><span class="op">)</span></span></code></pre></div>
<p>However, unfortunately these functions and methods have not been
validated and QC’ed, I can not guarantee that all of them are entirely
proper and error-free. But I always strive to compare the results to
other resources in order to obtain a consistent for them. And because
some of them were utilized in my past usual work process, so I believe
the quality of this package is temporarily sufficient to use.</p>
<p>In this vignette you are going to learn how to:</p>
<ul>
<li>Estimate of sample size for trials, following NMPA guideline.</li>
<li>Evaluate diagnostic accuracy with/without reference, following CLSI
EP12-A2.</li>
<li>Perform regression methods analysis and plots, following CLSI
EP09-A3.</li>
<li>Perform bland-Altman analysis and plots, following CLSI
EP09-A3.</li>
<li>Detect outliers with 4E method from CLSI EP09-A2 and ESD from CLSI
EP09-A3.</li>
<li>Estimate bias in medical decision level, following CLSI
EP09-A3.</li>
<li>Perform Pearson and Spearman correlation analysis adding hypothesis
test and confidence interval.</li>
<li>Evaluate Reference Range/Interval, following CLSI EP28-A3 and NMPA
guideline.</li>
<li>Add paired ROC/AUC test for superiority and non-inferiority trials,
following CLSI EP05-A3/EP15-A3.</li>
<li>Perform reproducibility analysis (reader precision) for
immunohistochemical assays, following CLSI I/LA28-A2 and NMPA
guideline.</li>
<li>Evaluate precision of quantitative measurements, following CLSI
EP05-A3.</li>
</ul>
<p>The reference of <code>mcradds</code> functions is available on <a href="https://kaigu1990.github.io/mcradds/reference/index.html">the
mcradds website functions reference</a>.</p>
<hr>
</div>
<div class="section level2">
<h2 id="common-ivd-trials-analyses">Common IVD Trials Analyses<a class="anchor" aria-label="anchor" href="#common-ivd-trials-analyses"></a>
</h2>
<p>Every above analysis purpose can be achieved by few functions or S4
methods from <code>mcradds</code> package, I will present the general
usage below.</p>
<p>The packages used in this vignette are:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/kaigu1990/mcradds" class="external-link">mcradds</a></span><span class="op">)</span></span></code></pre></div>
<p>The data sets with different purposes used in this vignette are:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"qualData"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"platelet"</span><span class="op">)</span></span>
<span><span class="co"># data(creatinine, package = "mcr")</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"calcium"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ldlroc"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"PDL1RP"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"glucose"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="estimation-of-sample-size">Estimation of Sample Size<a class="anchor" aria-label="anchor" href="#estimation-of-sample-size"></a>
</h3>
<div class="section level4">
<h4 id="example-1-1">Example 1.1<a class="anchor" aria-label="anchor" href="#example-1-1"></a>
</h4>
<p>Suppose that the expected sensitivity criteria of an new assay is
<code>0.9</code>, and the clinical acceptable criteria is
<code>0.85</code>. If we conduct a two-sided normal Z-test at a
significance level of <code>α = 0.05</code> and achieve a power of 80%,
the total sample is <code>363</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/size_one_prop.html">size_one_prop</a></span><span class="op">(</span>p1 <span class="op">=</span> <span class="fl">0.9</span>, p0 <span class="op">=</span> <span class="fl">0.85</span>, alpha <span class="op">=</span> <span class="fl">0.05</span>, power <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Sample size determination for one Proportion </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Call: size_one_prop(p1 = 0.9, p0 = 0.85, alpha = 0.05, power = 0.8)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    optimal sample size: n = 363 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    p1:0.9 p0:0.85 alpha:0.05 power:0.8 alternative:two.sided</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="example-1-2">Example 1.2<a class="anchor" aria-label="anchor" href="#example-1-2"></a>
</h4>
<p>Suppose that the expected sensitivity criteria of an new assay is
<code>0.85</code>, and the lower 95% confidence interval of Wilson Score
at a significance level of <code>α = 0.05</code> for criteria is
<code>0.8</code>, the total sample is <code>246</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/size_ci_one_prop.html">size_ci_one_prop</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.85</span>, lr <span class="op">=</span> <span class="fl">0.8</span>, alpha <span class="op">=</span> <span class="fl">0.05</span>, method <span class="op">=</span> <span class="st">"wilson"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Sample size determination for a Given Lower Confidence Interval </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Call: size_ci_one_prop(p = 0.85, lr = 0.8, alpha = 0.05, method = "wilson")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    optimal sample size: n = 246 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    p:0.85 lr:0.8 alpha:0.05 interval:c(1, 1e+05) tol:1e-05 alternative:two.sided method:wilson</span></span></code></pre></div>
<p>If we don’t want to use the CI of Wilson Score just following the
NMPA’s suggestion in the appendix, the CI of Simple-asymptotic is
recommended with the <code>196</code> of sample size, as shown
below.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/size_ci_one_prop.html">size_ci_one_prop</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.85</span>, lr <span class="op">=</span> <span class="fl">0.8</span>, alpha <span class="op">=</span> <span class="fl">0.05</span>, method <span class="op">=</span> <span class="st">"simple-asymptotic"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Sample size determination for a Given Lower Confidence Interval </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Call: size_ci_one_prop(p = 0.85, lr = 0.8, alpha = 0.05, method = "simple-asymptotic")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    optimal sample size: n = 196 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    p:0.85 lr:0.8 alpha:0.05 interval:c(1, 1e+05) tol:1e-05 alternative:two.sided method:simple-asymptotic</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="example-1-3">Example 1.3<a class="anchor" aria-label="anchor" href="#example-1-3"></a>
</h4>
<p>Suppose that the expected correlation coefficient between test and
reference assays is <code>0.95</code>, and the clinical acceptable
criteria is <code>0.9</code>. If we conduct an one-sided test at a
significance level of <code>α = 0.025</code> and achieve a power of 80%,
the total sample is <code>64</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/size_corr.html">size_corr</a></span><span class="op">(</span>r1 <span class="op">=</span> <span class="fl">0.95</span>, r0 <span class="op">=</span> <span class="fl">0.9</span>, alpha <span class="op">=</span> <span class="fl">0.025</span>, power <span class="op">=</span> <span class="fl">0.8</span>, alternative <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Sample size determination for testing Pearson's Correlation </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Call: size_corr(r1 = 0.95, r0 = 0.9, alpha = 0.025, power = 0.8, alternative = "greater")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    optimal sample size: n = 64 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    r1:0.95 r0:0.9 alpha:0.025 power:0.8 alternative:greater</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="example-1-4">Example 1.4<a class="anchor" aria-label="anchor" href="#example-1-4"></a>
</h4>
<p>Suppose that the expected correlation coefficient between test and
reference assays is <code>0.9</code>, and the lower 95% confidence
interval at a significance level of <code>α = 0.025</code> for the
criteria is greater than <code>0.85</code>, the total sample is
<code>86</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/size_ci_corr.html">size_ci_corr</a></span><span class="op">(</span>r <span class="op">=</span> <span class="fl">0.9</span>, lr <span class="op">=</span> <span class="fl">0.85</span>, alpha <span class="op">=</span> <span class="fl">0.025</span>, alternative <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Sample size determination for a Given Lower Confidence Interval of Pearson's Correlation </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Call: size_ci_corr(r = 0.9, lr = 0.85, alpha = 0.025, alternative = "greater")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    optimal sample size: n = 86 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    r:0.9 lr:0.85 alpha:0.025 interval:c(10, 1e+05) tol:1e-05 alternative:greater</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="evaluation-of-diagnostic-accuracy">Evaluation of Diagnostic Accuracy<a class="anchor" aria-label="anchor" href="#evaluation-of-diagnostic-accuracy"></a>
</h3>
<div class="section level4">
<h4 id="create-2x2-contingency-table">Create 2x2 contingency table<a class="anchor" aria-label="anchor" href="#create-2x2-contingency-table"></a>
</h4>
<p>Assume that you have a wide structure data like <code>qualData</code>
contains the measurements of candidate and comparative assays.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">qualData</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Sample ComparativeN CandidateN</span></span>
<span><span class="co">#&gt; 1    ID1            1          1</span></span>
<span><span class="co">#&gt; 2    ID2            1          0</span></span>
<span><span class="co">#&gt; 3    ID3            0          0</span></span>
<span><span class="co">#&gt; 4    ID4            1          0</span></span>
<span><span class="co">#&gt; 5    ID5            1          1</span></span>
<span><span class="co">#&gt; 6    ID6            1          1</span></span></code></pre></div>
<p>In this scenario, you’d better define the <code>formula</code> with
candidate assay first, followed by comparative assay to the right of
formula, such as right of <code>~</code>. If not, you should add the
<code>dimname</code> argument to indicate which the row and column names
2x2 contingency table, and then define the order of levels you prefer
to.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tb</span> <span class="op">&lt;-</span> <span class="va">qualData</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/diagTab.html">diagTab</a></span><span class="op">(</span></span>
<span>    formula <span class="op">=</span> <span class="op">~</span> <span class="va">CandidateN</span> <span class="op">+</span> <span class="va">ComparativeN</span>,</span>
<span>    levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">tb</span></span>
<span><span class="co">#&gt; Contingency Table: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; levels: 1 0</span></span>
<span><span class="co">#&gt;           ComparativeN</span></span>
<span><span class="co">#&gt; CandidateN   1   0</span></span>
<span><span class="co">#&gt;          1 122   8</span></span>
<span><span class="co">#&gt;          0  16  54</span></span></code></pre></div>
<p>Assume that there is a long structure data needs to be summarized, a
dummy data is shown below. The formula should be define in another
format. The left of formula is the type of assay, and the right of it is
the measurement.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dummy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1001"</span>, <span class="st">"1001"</span>, <span class="st">"1002"</span>, <span class="st">"1002"</span>, <span class="st">"1003"</span>, <span class="st">"1003"</span><span class="op">)</span>,</span>
<span>  value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Test"</span>, <span class="st">"Ref"</span>, <span class="st">"Test"</span>, <span class="st">"Ref"</span>, <span class="st">"Test"</span>, <span class="st">"Ref"</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/diagTab.html">diagTab</a></span><span class="op">(</span></span>
<span>    formula <span class="op">=</span> <span class="va">type</span> <span class="op">~</span> <span class="va">value</span>,</span>
<span>    bysort <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>    dimname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Test"</span>, <span class="st">"Ref"</span><span class="op">)</span>,</span>
<span>    levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">dummy</span></span>
<span><span class="co">#&gt; Contingency Table: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; levels: 1 0</span></span>
<span><span class="co">#&gt;     Ref</span></span>
<span><span class="co">#&gt; Test 1 0</span></span>
<span><span class="co">#&gt;    1 1 1</span></span>
<span><span class="co">#&gt;    0 0 1</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="with-referencegold-standard">With Reference/Gold Standard<a class="anchor" aria-label="anchor" href="#with-referencegold-standard"></a>
</h4>
<p>Next step is to utilize the <code>getAccuracy</code> method to
calculate the diagnostic accuracy. If the reference assay is gold
standard, the argument <code>ref</code> should be <code>r</code> which
means ‘reference’. The output will present several indicators,
sensitivity (<code>sens</code>), specificity (<code>spec</code>),
positive/negative predictive value (<code>ppv</code>/<code>npv</code>)
and positive/negative likelihood ratio
(<code>plr</code>/<code>nlr</code>). More details can been found in
<code><a href="../reference/getAccuracy.html">?getAccuracy</a></code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Default method is Wilson score, and digit is 4.</span></span>
<span><span class="va">tb</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/getAccuracy.html">getAccuracy</a></span><span class="op">(</span>ref <span class="op">=</span> <span class="st">"r"</span><span class="op">)</span></span>
<span><span class="co">#&gt;         EST LowerCI UpperCI</span></span>
<span><span class="co">#&gt; sens 0.8841  0.8200  0.9274</span></span>
<span><span class="co">#&gt; spec 0.8710  0.7655  0.9331</span></span>
<span><span class="co">#&gt; ppv  0.9385  0.8833  0.9685</span></span>
<span><span class="co">#&gt; npv  0.7714  0.6605  0.8541</span></span>
<span><span class="co">#&gt; plr  6.8514  3.5785 13.1181</span></span>
<span><span class="co">#&gt; nlr  0.1331  0.0832  0.2131</span></span>
<span></span>
<span><span class="co"># Alter the number of digit to 2.</span></span>
<span><span class="va">tb</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/getAccuracy.html">getAccuracy</a></span><span class="op">(</span>ref <span class="op">=</span> <span class="st">"r"</span>, digit <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;       EST LowerCI UpperCI</span></span>
<span><span class="co">#&gt; sens 0.88    0.82    0.93</span></span>
<span><span class="co">#&gt; spec 0.87    0.77    0.93</span></span>
<span><span class="co">#&gt; ppv  0.94    0.88    0.97</span></span>
<span><span class="co">#&gt; npv  0.77    0.66    0.85</span></span>
<span><span class="co">#&gt; plr  6.85    3.58   13.12</span></span>
<span><span class="co">#&gt; nlr  0.13    0.08    0.21</span></span>
<span></span>
<span><span class="co"># Alter the number of digit to 2.</span></span>
<span><span class="va">tb</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/getAccuracy.html">getAccuracy</a></span><span class="op">(</span>ref <span class="op">=</span> <span class="st">"r"</span>, r_ci <span class="op">=</span> <span class="st">"clopper-pearson"</span><span class="op">)</span></span>
<span><span class="co">#&gt;         EST LowerCI UpperCI</span></span>
<span><span class="co">#&gt; sens 0.8841  0.8186  0.9323</span></span>
<span><span class="co">#&gt; spec 0.8710  0.7615  0.9426</span></span>
<span><span class="co">#&gt; ppv  0.9385  0.8823  0.9731</span></span>
<span><span class="co">#&gt; npv  0.7714  0.6555  0.8633</span></span>
<span><span class="co">#&gt; plr  6.8514  3.5785 13.1181</span></span>
<span><span class="co">#&gt; nlr  0.1331  0.0832  0.2131</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="without-referencegold-standard">Without Reference/Gold Standard<a class="anchor" aria-label="anchor" href="#without-referencegold-standard"></a>
</h4>
<p>If the reference assay is not the gold standard, for example, a
comparative assay that has been approved for market sale, the
<code>ref</code> should be <code>nr</code> which means ‘not reference’.
The output will present the indicators, positive/negative percent
agreement (<code>ppa</code>/<code>npa</code>) and overall percent
agreement (<code>opa</code>).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># When the reference is a comparative assay, not gold standard.</span></span>
<span><span class="va">tb</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/getAccuracy.html">getAccuracy</a></span><span class="op">(</span>ref <span class="op">=</span> <span class="st">"nr"</span>, nr_ci <span class="op">=</span> <span class="st">"wilson"</span><span class="op">)</span></span>
<span><span class="co">#&gt;        EST LowerCI UpperCI</span></span>
<span><span class="co">#&gt; ppa 0.8841  0.8200  0.9274</span></span>
<span><span class="co">#&gt; npa 0.8710  0.7655  0.9331</span></span>
<span><span class="co">#&gt; opa 0.8800  0.8277  0.9180</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="regression-coefficient-and-bias-in-medical-decision-level">Regression coefficient and bias in medical decision level<a class="anchor" aria-label="anchor" href="#regression-coefficient-and-bias-in-medical-decision-level"></a>
</h3>
<div class="section level4">
<h4 id="estimating-regression-coefficient">Estimating Regression coefficient<a class="anchor" aria-label="anchor" href="#estimating-regression-coefficient"></a>
</h4>
<p>Regression agreement is a very important criteria in method
comparison trials that can be achieved by <code>mcr</code> package that
has provided a series of regression methods, such as ‘Deming’,
‘Passing-Bablok’,’ weighted Deming’ and so on. The main and key
functions have been wrapped in the <code>mcradds</code>, such as
<code>mcreg</code>, <code>getCoefficients</code> and
<code>calcBias</code>. If you would like to utilize the entire functions
in <code>mcr</code> package, just adding the specific package name in
front of each of them, like <code>mcr::calcBias()</code>, so that it
looks the function is called from <code>mcr</code> package.</p>
<p>Please to be noted that the <code>mcr</code> package is not available
in CRAN, so the <code>mcreg</code> or <code>mcreg2</code> function can
not be used temporarily.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Deming regression</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">mcreg</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">platelet</span><span class="op">$</span><span class="va">Comparative</span>, y <span class="op">=</span> <span class="va">platelet</span><span class="op">$</span><span class="va">Candidate</span>,</span>
<span>  error.ratio <span class="op">=</span> <span class="fl">1</span>, method.reg <span class="op">=</span> <span class="st">"Deming"</span>, method.ci <span class="op">=</span> <span class="st">"jackknife"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">printSummary</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="fu">getCoefficients</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="estimating-bias-in-medical-decision-level">Estimating Bias in Medical Decision Level<a class="anchor" aria-label="anchor" href="#estimating-bias-in-medical-decision-level"></a>
</h4>
<p>Once you have obtained this regression equation, whether ‘Deming’ or
‘Passing-Bablok’, you can use it to estimate the bias in medical
decision level. Suppose that you know the medical decision level of one
assay is <code>30</code>, obviously this is a make-up number. Then you
can use the <code>fit</code> object above to estimate the bias using
<code>calcBias</code> function.</p>
<p>Please to be noted that the <code>mcr</code> package is not available
in CRAN, so the <code>calcBias</code> function can not be used
temporarily.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># absolute bias.</span></span>
<span><span class="fu">calcBias</span><span class="op">(</span><span class="va">fit</span>, x.levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># proportional bias.</span></span>
<span><span class="fu">calcBias</span><span class="op">(</span><span class="va">fit</span>, x.levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"proportional"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="bland-altman-analysis">Bland-Altman Analysis<a class="anchor" aria-label="anchor" href="#bland-altman-analysis"></a>
</h3>
<p>The Bland-Altman analysis is also an agreement criteria in method
comparison trials. And in term of authority’s request, we will normally
present two categories: absolute difference and relative difference, in
order to evaluate the agreements in both aspects. The outputs are
descriptive statistics, including ‘mean’, ‘median’, ‘Q1’, ‘Q3’, ‘min’,
‘max’, ‘CI’ (confidence interval of mean) and ‘LoA’ (Limit of
Agreement).</p>
<p>Please make sure the difference type before calculation, answer the
question how to define the absolute and relative difference. More
details information can be found in <code><a href="../reference/h_difference.html">?h_difference</a></code>, where
has five types available as the option. Default is that the absolute
difference is derived by <code>Y-X</code>, and relative difference is
<code>(Y-X)/(0.5*(X+Y))</code>. Sometime if you think the reference
(<code>X</code>) is the gold standard and has a good agreement with test
(<code>Y</code>), the relative difference type can be
<code>type2 = 4</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Default difference type</span></span>
<span><span class="fu"><a href="../reference/blandAltman.html">blandAltman</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">platelet</span><span class="op">$</span><span class="va">Comparative</span>, y <span class="op">=</span> <span class="va">platelet</span><span class="op">$</span><span class="va">Candidate</span>,</span>
<span>  type1 <span class="op">=</span> <span class="fl">3</span>, type2 <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;  Call: blandAltman(x = platelet$Comparative, y = platelet$Candidate, </span></span>
<span><span class="co">#&gt;     type1 = 3, type2 = 5)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Absolute difference type:  Y-X</span></span>
<span><span class="co">#&gt;   Relative difference type:  (Y-X)/(0.5*(X+Y))</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                             Absolute.difference Relative.difference</span></span>
<span><span class="co">#&gt; N                                           120                 120</span></span>
<span><span class="co">#&gt; Mean (SD)                        7.330 (15.990)      0.064 ( 0.145)</span></span>
<span><span class="co">#&gt; Median                                    6.350               0.055</span></span>
<span><span class="co">#&gt; Q1, Q3                         ( 0.150, 15.750)    ( 0.001,  0.118)</span></span>
<span><span class="co">#&gt; Min, Max                      (-47.800, 42.100)    (-0.412,  0.667)</span></span>
<span><span class="co">#&gt; Limit of Agreement            (-24.011, 38.671)    (-0.220,  0.347)</span></span>
<span><span class="co">#&gt; Confidence Interval of Mean    ( 4.469, 10.191)    ( 0.038,  0.089)</span></span>
<span></span>
<span><span class="co"># Change relative different type to 4.</span></span>
<span><span class="fu"><a href="../reference/blandAltman.html">blandAltman</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">platelet</span><span class="op">$</span><span class="va">Comparative</span>, y <span class="op">=</span> <span class="va">platelet</span><span class="op">$</span><span class="va">Candidate</span>,</span>
<span>  type1 <span class="op">=</span> <span class="fl">3</span>, type2 <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;  Call: blandAltman(x = platelet$Comparative, y = platelet$Candidate, </span></span>
<span><span class="co">#&gt;     type1 = 3, type2 = 4)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Absolute difference type:  Y-X</span></span>
<span><span class="co">#&gt;   Relative difference type:  (Y-X)/X</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                             Absolute.difference Relative.difference</span></span>
<span><span class="co">#&gt; N                                           120                 120</span></span>
<span><span class="co">#&gt; Mean (SD)                        7.330 (15.990)      0.078 ( 0.173)</span></span>
<span><span class="co">#&gt; Median                                    6.350               0.056</span></span>
<span><span class="co">#&gt; Q1, Q3                         ( 0.150, 15.750)    ( 0.001,  0.125)</span></span>
<span><span class="co">#&gt; Min, Max                      (-47.800, 42.100)    (-0.341,  1.000)</span></span>
<span><span class="co">#&gt; Limit of Agreement            (-24.011, 38.671)    (-0.261,  0.417)</span></span>
<span><span class="co">#&gt; Confidence Interval of Mean    ( 4.469, 10.191)    ( 0.047,  0.109)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="detecting-outliers">Detecting Outliers<a class="anchor" aria-label="anchor" href="#detecting-outliers"></a>
</h3>
<p>As we all know, there are numerous statistical methodologies to
detect the outliers. Here I try to show which methods will be commonly
used in IVD trials with different purposes.</p>
<p>First and foremost, only quantitative data will generate outliers, so
the detecting process only occurred in quantitative trials. And then in
the method comparison trials, the detected outliers will be used for
sensitive analysis in common. For example, if you detect 5 outliers in a
200 subjects trial, you should conduct a sensitive analysis with and
without outliers to interpret there is no difference in both scenarios.
Here there are two CLSI’s recommended approaches,4E and ESD, wit the
latter one being recommended in the most recent version.</p>
<p>In <code>mcradds</code> package, you can utilize the
<code>getOutlier</code> method to detect outliers with the
<code>method</code> argument to define the which method you’d like, and
<code>difference</code> arguments for which difference type like
‘absolute’ or ‘relative’ would be used.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ESD approach</span></span>
<span><span class="va">ba</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/blandAltman.html">blandAltman</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">platelet</span><span class="op">$</span><span class="va">Comparative</span>, y <span class="op">=</span> <span class="va">platelet</span><span class="op">$</span><span class="va">Candidate</span><span class="op">)</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getOutlier.html">getOutlier</a></span><span class="op">(</span><span class="va">ba</span>, method <span class="op">=</span> <span class="st">"ESD"</span>, difference <span class="op">=</span> <span class="st">"rel"</span><span class="op">)</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">stat</span></span>
<span><span class="co">#&gt;   i       Mean        SD          x Obs     ESDi   Lambda Outlier</span></span>
<span><span class="co">#&gt; 1 1 0.06356753 0.1447540  0.6666667   1 4.166372 3.445148    TRUE</span></span>
<span><span class="co">#&gt; 2 2 0.05849947 0.1342496  0.5783972   4 3.872621 3.442394    TRUE</span></span>
<span><span class="co">#&gt; 3 3 0.05409356 0.1258857  0.5321101   2 3.797226 3.439611    TRUE</span></span>
<span><span class="co">#&gt; 4 4 0.05000794 0.1183096 -0.4117647  10 3.903086 3.436800    TRUE</span></span>
<span><span class="co">#&gt; 5 5 0.05398874 0.1106738 -0.3132530  14 3.318236 3.433961   FALSE</span></span>
<span><span class="co">#&gt; 6 6 0.05718215 0.1056542 -0.2566372  23 2.970250 3.431092   FALSE</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">outmat</span></span>
<span><span class="co">#&gt;   sid    x    y</span></span>
<span><span class="co">#&gt; 1   1  1.5  3.0</span></span>
<span><span class="co">#&gt; 2   2  4.0  6.9</span></span>
<span><span class="co">#&gt; 3   4 10.2 18.5</span></span>
<span><span class="co">#&gt; 4  10 16.4 10.8</span></span>
<span></span>
<span><span class="co"># 4E approach</span></span>
<span><span class="va">ba2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/blandAltman.html">blandAltman</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">platelet</span><span class="op">$</span><span class="va">Comparative</span>, y <span class="op">=</span> <span class="va">platelet</span><span class="op">$</span><span class="va">Candidate</span><span class="op">)</span></span>
<span><span class="va">out2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getOutlier.html">getOutlier</a></span><span class="op">(</span><span class="va">ba2</span>, method <span class="op">=</span> <span class="st">"4E"</span><span class="op">)</span></span>
<span><span class="co">#&gt; No outlier is detected.</span></span>
<span><span class="va">out2</span><span class="op">$</span><span class="va">stat</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="va">out2</span><span class="op">$</span><span class="va">outmat</span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre></div>
<p>In addition, <code>mcradds</code> also provides outlier methods for
evaluating Reference Range, such as ‘Tukey’ and ‘Dixon’ that have been
wrapped in <code><a href="../reference/refInterval.html">refInterval()</a></code> function.</p>
</div>
<div class="section level3">
<h3 id="hypothesis-of-pearson-and-spearman">Hypothesis of Pearson and Spearman<a class="anchor" aria-label="anchor" href="#hypothesis-of-pearson-and-spearman"></a>
</h3>
<p>The correlation coefficient of Pearson is a helpful criteria for
assessing the agreement between test and reference assays. To compute
the coefficient and P value in R, the <code><a href="https://rdrr.io/r/stats/cor.test.html" class="external-link">cor.test()</a></code> function
is commonly used. However the P value relies on the hypothesis of
<code>H0=0</code>, which doesn’t meet the requirement from authority.
Because we are required to provide the P value with <code>H0=0.7</code>
sometimes. Thus in this case, I suggest you should use the
<code><a href="../reference/pearsonTest.html">pearsonTest()</a></code> function instead, and the hypothesis is based
on Fisher’s Z transformation of the correlation.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">44.4</span>, <span class="fl">45.9</span>, <span class="fl">41.9</span>, <span class="fl">53.3</span>, <span class="fl">44.7</span>, <span class="fl">44.1</span>, <span class="fl">50.7</span>, <span class="fl">45.2</span>, <span class="fl">60.1</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.6</span>, <span class="fl">3.1</span>, <span class="fl">2.5</span>, <span class="fl">5.0</span>, <span class="fl">3.6</span>, <span class="fl">4.0</span>, <span class="fl">5.2</span>, <span class="fl">2.8</span>, <span class="fl">3.8</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pearsonTest.html">pearsonTest</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, h0 <span class="op">=</span> <span class="fl">0.5</span>, alternative <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $stat</span></span>
<span><span class="co">#&gt;        cor    lowerci    upperci          Z       pval </span></span>
<span><span class="co">#&gt;  0.5711816 -0.1497426  0.8955795  0.2448722  0.4032777 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "Pearson's correlation"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $conf.level</span></span>
<span><span class="co">#&gt; [1] 0.95</span></span></code></pre></div>
<p>Since the <code><a href="https://rdrr.io/r/stats/cor.test.html" class="external-link">cor.test()</a></code> function can not provide the
confidence interval and special hypothesis for Spearman, the
<code><a href="../reference/spearmanTest.html">spearmanTest()</a></code> function is recommended. This function
computes the CI using bootstrap method, and the hypothesis is based on
Fisher’s Z transformation of the correlation, but with the variance
proposed by Bonett and Wright (2000), not the same as Pearson’s.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">44.4</span>, <span class="fl">45.9</span>, <span class="fl">41.9</span>, <span class="fl">53.3</span>, <span class="fl">44.7</span>, <span class="fl">44.1</span>, <span class="fl">50.7</span>, <span class="fl">45.2</span>, <span class="fl">60.1</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.6</span>, <span class="fl">3.1</span>, <span class="fl">2.5</span>, <span class="fl">5.0</span>, <span class="fl">3.6</span>, <span class="fl">4.0</span>, <span class="fl">5.2</span>, <span class="fl">2.8</span>, <span class="fl">3.8</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spearmanTest.html">spearmanTest</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, h0 <span class="op">=</span> <span class="fl">0.5</span>, alternative <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $stat</span></span>
<span><span class="co">#&gt;        cor    lowerci    upperci          Z       pval </span></span>
<span><span class="co">#&gt;  0.6000000 -0.1652174  0.9816637  0.3243526  0.3728355 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "Spearman's correlation"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $conf.level</span></span>
<span><span class="co">#&gt; [1] 0.95</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="establishing-reference-rangeinterval">Establishing Reference Range/Interval<a class="anchor" aria-label="anchor" href="#establishing-reference-rangeinterval"></a>
</h3>
<p>The <code>refInterval</code> function provides two outlier methods
<code>Tukey</code> and <code>Dixon</code>, and three methods mentioned
in CLSI to establish the reference interval (RI).</p>
<p>The first is parametric method that follows the normal distribution
to compute the confidence interval.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/refInterval.html">refInterval</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">calcium</span><span class="op">$</span><span class="va">Value</span>, RI_method <span class="op">=</span> <span class="st">"parametric"</span>, CI_method <span class="op">=</span> <span class="st">"parametric"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Reference Interval Method: parametric, Confidence Interval Method: parametric </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Call: refInterval(x = calcium$Value, RI_method = "parametric", CI_method = "parametric")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   N = 240</span></span>
<span><span class="co">#&gt;   Outliers: NULL</span></span>
<span><span class="co">#&gt;   Reference Interval: 9.05, 10.32</span></span>
<span><span class="co">#&gt;   RefLower Confidence Interval: 8.9926, 9.1100</span></span>
<span><span class="co">#&gt;   Refupper Confidence Interval: 10.2584, 10.3757</span></span></code></pre></div>
<p>The second one is nonparametric method that computes the 2.5th and
97.5th percentile if the range of reference interval is 95%.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/refInterval.html">refInterval</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">calcium</span><span class="op">$</span><span class="va">Value</span>, RI_method <span class="op">=</span> <span class="st">"nonparametric"</span>, CI_method <span class="op">=</span> <span class="st">"nonparametric"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Reference Interval Method: nonparametric, Confidence Interval Method: nonparametric </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Call: refInterval(x = calcium$Value, RI_method = "nonparametric", CI_method = "nonparametric")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   N = 240</span></span>
<span><span class="co">#&gt;   Outliers: NULL</span></span>
<span><span class="co">#&gt;   Reference Interval: 9.10, 10.30</span></span>
<span><span class="co">#&gt;   RefLower Confidence Interval: 8.9000, 9.2000</span></span>
<span><span class="co">#&gt;   Refupper Confidence Interval: 10.3000, 10.4000</span></span></code></pre></div>
<p>The third one is robust method, which is slightly complicated and
involves an iterative procedure based on the formulas in EP28A3. And the
observations are weighted according to their distance from the central
tendency that is initially estimated by median and MAD(the median
absolute deviation).</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/refInterval.html">refInterval</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">calcium</span><span class="op">$</span><span class="va">Value</span>, RI_method <span class="op">=</span> <span class="st">"robust"</span>, CI_method <span class="op">=</span> <span class="st">"boot"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Bootstrape process could take a short while."</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Reference Interval Method: robust, Confidence Interval Method: boot </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Call: refInterval(x = calcium$Value, RI_method = "robust", CI_method = "boot")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   N = 240</span></span>
<span><span class="co">#&gt;   Outliers: NULL</span></span>
<span><span class="co">#&gt;   Reference Interval: 9.04, 10.32</span></span>
<span><span class="co">#&gt;   RefLower Confidence Interval: 8.9795, 9.0974</span></span>
<span><span class="co">#&gt;   Refupper Confidence Interval: 10.2575, 10.3757</span></span></code></pre></div>
<p>The first two methods are also accepted by NMPA guideline, but the
robust method is not recommended by NMPA because if you want to
establish a reference interval for your assay, you must collect the at
least 120 samples in China. If the number is less than 120, it can not
ensure the accuracy of the results. The CLSI working group is hesitant
to recommend this method as well, except in the most extreme
instances.</p>
<p>By default, the confidence interval (CI) will be presented depending
on which RI method is utilized.</p>
<ul>
<li>If the RI method is <code>parametric</code>, the CI method should be
<code>parametric</code> as well.</li>
<li>If the RI method is <code>nonparametric</code> and the sample size
is up to 120 observations, the <code>nonparametric</code> of CI is
suggested. Otherwise if the sample size is below to 120, the
<code>boot</code> method of CI is the better choice. You need to be
aware that the <code>nonparametric</code> method for CI only allows the
<code>refLevel = 0.95</code> and <code>confLevel = 0.9</code> arguments,
if not the <code>boot</code> methods of CI will be used
automatically.</li>
<li>If the RI method is <code>robust</code> method, the method of CI
must be <code>boot</code>.</li>
</ul>
<p>If you would like to compute the 90% reference interval rather than
90%, just alter <code>refLevel = 0.9</code>. So the confidence interval
is similar to be altered to <code>confLevel = 0.95</code> if you would
like compute the 95% confidence interval for each limit of reference
interval.</p>
</div>
<div class="section level3">
<h3 id="paired-auc-test">Paired AUC Test<a class="anchor" aria-label="anchor" href="#paired-auc-test"></a>
</h3>
<p>The <code>aucTest</code> function compares two AUC of paired
two-sample diagnostic assays using the standardized difference method,
which has a small difference in SE computation when compared to unpaired
design. Because the samples in a paired design are not considered
independent, the SE can not be computed directly by the Delong’s method
in <code>pROC</code> package.</p>
<p>In order to evaluate two paired assays, the <code>aucTest</code>
function has three assessment methods including ‘difference’,
‘non-inferiority’ and ‘superiority’, as shown in Liu(2006)’s article
below.</p>
<blockquote>
<p>Jen-Pei Liu (2006) “Tests of equivalence and non-inferiority for
diagnostic accuracy based on the paired areas under ROC curves”.
<em>Statist. Med.</em>, 25:1219–1238. DOI: 10.1002/sim.2358.</p>
</blockquote>
<p>Suppose that you want to compare the paired AUC from OxLDL and LDL
assays in <code>ldlroc</code> data set, and the null hypothesis is there
is no difference of AUC area.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># H0 : Difference between areas = 0:</span></span>
<span><span class="fu"><a href="../reference/aucTest.html">aucTest</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ldlroc</span><span class="op">$</span><span class="va">LDL</span>, y <span class="op">=</span> <span class="va">ldlroc</span><span class="op">$</span><span class="va">OxLDL</span>, response <span class="op">=</span> <span class="va">ldlroc</span><span class="op">$</span><span class="va">Diagnosis</span><span class="op">)</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting direction: controls &lt; cases</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The hypothesis for testing difference based on Paired ROC curve</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Test assay:</span></span>
<span><span class="co">#&gt;   Area under the curve: 0.7995</span></span>
<span><span class="co">#&gt;   Standard Error(SE): 0.0620</span></span>
<span><span class="co">#&gt;   95% Confidence Interval(CI): 0.6781-0.9210 (DeLong)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Reference/standard assay:</span></span>
<span><span class="co">#&gt;   Area under the curve: 0.5617</span></span>
<span><span class="co">#&gt;   Standard Error(SE): 0.0836</span></span>
<span><span class="co">#&gt;   95% Confidence Interval(CI): 0.3979-0.7255 (DeLong)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Comparison of Paired AUC:</span></span>
<span><span class="co">#&gt;   Alternative hypothesis: the difference in AUC is difference to 0</span></span>
<span><span class="co">#&gt;   Difference of AUC: 0.2378</span></span>
<span><span class="co">#&gt;   Standard Error(SE): 0.0790</span></span>
<span><span class="co">#&gt;   95% Confidence Interval(CI): 0.0829-0.3927 (standardized differenec method)</span></span>
<span><span class="co">#&gt;   Z: 3.0088</span></span>
<span><span class="co">#&gt;   Pvalue: 0.002623</span></span></code></pre></div>
<p>Suppose that you want to see if the OxLDL assay is superior to LDL
assay when the margin is equal to <code>0.1</code>. In this case the
null hypothesis is the difference is less than <code>0.1</code>.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># H0 : Superiority margin &lt;= 0.1:</span></span>
<span><span class="fu"><a href="../reference/aucTest.html">aucTest</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">ldlroc</span><span class="op">$</span><span class="va">LDL</span>, y <span class="op">=</span> <span class="va">ldlroc</span><span class="op">$</span><span class="va">OxLDL</span>, response <span class="op">=</span> <span class="va">ldlroc</span><span class="op">$</span><span class="va">Diagnosis</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"superiority"</span>, h0 <span class="op">=</span> <span class="fl">0.1</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting direction: controls &lt; cases</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The hypothesis for testing superiority based on Paired ROC curve</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Test assay:</span></span>
<span><span class="co">#&gt;   Area under the curve: 0.7995</span></span>
<span><span class="co">#&gt;   Standard Error(SE): 0.0620</span></span>
<span><span class="co">#&gt;   95% Confidence Interval(CI): 0.6781-0.9210 (DeLong)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Reference/standard assay:</span></span>
<span><span class="co">#&gt;   Area under the curve: 0.5617</span></span>
<span><span class="co">#&gt;   Standard Error(SE): 0.0836</span></span>
<span><span class="co">#&gt;   95% Confidence Interval(CI): 0.3979-0.7255 (DeLong)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Comparison of Paired AUC:</span></span>
<span><span class="co">#&gt;   Alternative hypothesis: the difference in AUC is superiority to 0.1</span></span>
<span><span class="co">#&gt;   Difference of AUC: 0.2378</span></span>
<span><span class="co">#&gt;   Standard Error(SE): 0.0790</span></span>
<span><span class="co">#&gt;   95% Confidence Interval(CI): 0.0829-0.3927 (standardized differenec method)</span></span>
<span><span class="co">#&gt;   Z: 1.7436</span></span>
<span><span class="co">#&gt;   Pvalue: 0.04061</span></span></code></pre></div>
<p>Suppose that you want to see if the OxLDL assay is non-inferior to
LDL assay when the margin is equal to <code>-0.1</code>. In this case
the null hypothesis is the difference is less than
<code>-0.1</code>.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># H0 : Non-inferiority margin &lt;= -0.1:</span></span>
<span><span class="fu"><a href="../reference/aucTest.html">aucTest</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">ldlroc</span><span class="op">$</span><span class="va">LDL</span>, y <span class="op">=</span> <span class="va">ldlroc</span><span class="op">$</span><span class="va">OxLDL</span>, response <span class="op">=</span> <span class="va">ldlroc</span><span class="op">$</span><span class="va">Diagnosis</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"non-inferiority"</span>, h0 <span class="op">=</span> <span class="op">-</span><span class="fl">0.1</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting direction: controls &lt; cases</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The hypothesis for testing non-inferiority based on Paired ROC curve</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Test assay:</span></span>
<span><span class="co">#&gt;   Area under the curve: 0.7995</span></span>
<span><span class="co">#&gt;   Standard Error(SE): 0.0620</span></span>
<span><span class="co">#&gt;   95% Confidence Interval(CI): 0.6781-0.9210 (DeLong)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Reference/standard assay:</span></span>
<span><span class="co">#&gt;   Area under the curve: 0.5617</span></span>
<span><span class="co">#&gt;   Standard Error(SE): 0.0836</span></span>
<span><span class="co">#&gt;   95% Confidence Interval(CI): 0.3979-0.7255 (DeLong)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Comparison of Paired AUC:</span></span>
<span><span class="co">#&gt;   Alternative hypothesis: the difference in AUC is non-inferiority to -0.1</span></span>
<span><span class="co">#&gt;   Difference of AUC: 0.2378</span></span>
<span><span class="co">#&gt;   Standard Error(SE): 0.0790</span></span>
<span><span class="co">#&gt;   95% Confidence Interval(CI): 0.0829-0.3927 (standardized differenec method)</span></span>
<span><span class="co">#&gt;   Z: 4.2739</span></span>
<span><span class="co">#&gt;   Pvalue: 9.606e-06</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="reproducibility-analysis-reader-precision">Reproducibility Analysis (Reader Precision)<a class="anchor" aria-label="anchor" href="#reproducibility-analysis-reader-precision"></a>
</h3>
<p>In the PDL1 assay trials, we must estimate the reader precision
between different readers or reads or sites, using the <code>APA</code>,
<code>ANA</code> and <code>OPA</code> as the primary endpoint. The
<code>getAccuracy</code> function can implement the computations as the
reader precision trials belong to qualitative trials. The only
distinction is that in this trial, there is no comparative assay, just
each stained specimen will be scored by different pathologists
(readers). So you can not determine which one can be as the reference,
instead that they compare each other in each comparison.</p>
<p>In the <code>PDL1RP</code> example data, 150 specimens were stained
with one PD-L1 assay in three different sites, 50 specimens for each.
For <code>PDL1RP$wtn_reader</code> sub-data, 3 readers were selected
from three different sites and each of them were responsible for scoring
50 specimens once. Thus you might want to evaluate the reproducibility
within three readers through three site.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reader</span> <span class="op">&lt;-</span> <span class="va">PDL1RP</span><span class="op">$</span><span class="va">btw_reader</span></span>
<span><span class="va">tb1</span> <span class="op">&lt;-</span> <span class="va">reader</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/diagTab.html">diagTab</a></span><span class="op">(</span></span>
<span>    formula <span class="op">=</span> <span class="va">Reader</span> <span class="op">~</span> <span class="va">Value</span>,</span>
<span>    bysort <span class="op">=</span> <span class="st">"Sample"</span>,</span>
<span>    levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Positive"</span>, <span class="st">"Negative"</span><span class="op">)</span>,</span>
<span>    rep <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    across <span class="op">=</span> <span class="st">"Site"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="fu"><a href="../reference/getAccuracy.html">getAccuracy</a></span><span class="op">(</span><span class="va">tb1</span>, ref <span class="op">=</span> <span class="st">"bnr"</span>, rng.seed <span class="op">=</span> <span class="fl">12306</span><span class="op">)</span></span>
<span><span class="co">#&gt;        EST LowerCI UpperCI</span></span>
<span><span class="co">#&gt; apa 0.9479  0.9260  0.9686</span></span>
<span><span class="co">#&gt; ana 0.9540  0.9342  0.9730</span></span>
<span><span class="co">#&gt; opa 0.9511  0.9311  0.9711</span></span></code></pre></div>
<p>For <code>PDL1RP$wtn_reader</code> sub-data, one reader was selected
from three different sites and each of them was responsible for scoring
50 specimens 3 times with a minimum of 2 weeks between reads that means
the process of score. Thus you might want to evaluate the
reproducibility within three reads through all specimens.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">read</span> <span class="op">&lt;-</span> <span class="va">PDL1RP</span><span class="op">$</span><span class="va">wtn_reader</span></span>
<span><span class="va">tb2</span> <span class="op">&lt;-</span> <span class="va">read</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/diagTab.html">diagTab</a></span><span class="op">(</span></span>
<span>    formula <span class="op">=</span> <span class="va">Order</span> <span class="op">~</span> <span class="va">Value</span>,</span>
<span>    bysort <span class="op">=</span> <span class="st">"Sample"</span>,</span>
<span>    levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Positive"</span>, <span class="st">"Negative"</span><span class="op">)</span>,</span>
<span>    rep <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    across <span class="op">=</span> <span class="st">"Sample"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="fu"><a href="../reference/getAccuracy.html">getAccuracy</a></span><span class="op">(</span><span class="va">tb2</span>, ref <span class="op">=</span> <span class="st">"bnr"</span>, rng.seed <span class="op">=</span> <span class="fl">12306</span><span class="op">)</span></span>
<span><span class="co">#&gt;        EST LowerCI UpperCI</span></span>
<span><span class="co">#&gt; apa 0.9442  0.9204  0.9657</span></span>
<span><span class="co">#&gt; ana 0.9489  0.9273  0.9681</span></span>
<span><span class="co">#&gt; opa 0.9467  0.9244  0.9667</span></span></code></pre></div>
<p>For <code>PDL1RP$btw_site</code> sub-data, one reader was selected
from three different sites and all of them were responsible for scoring
150 specimens once, that collected from those three sites. Thus you
might want to evaluate the reproducibility within three site.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">site</span> <span class="op">&lt;-</span> <span class="va">PDL1RP</span><span class="op">$</span><span class="va">btw_site</span></span>
<span><span class="va">tb3</span> <span class="op">&lt;-</span> <span class="va">site</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/diagTab.html">diagTab</a></span><span class="op">(</span></span>
<span>    formula <span class="op">=</span> <span class="va">Site</span> <span class="op">~</span> <span class="va">Value</span>,</span>
<span>    bysort <span class="op">=</span> <span class="st">"Sample"</span>,</span>
<span>    levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Positive"</span>, <span class="st">"Negative"</span><span class="op">)</span>,</span>
<span>    rep <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    across <span class="op">=</span> <span class="st">"Sample"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="fu"><a href="../reference/getAccuracy.html">getAccuracy</a></span><span class="op">(</span><span class="va">tb2</span>, ref <span class="op">=</span> <span class="st">"bnr"</span>, rng.seed <span class="op">=</span> <span class="fl">12306</span><span class="op">)</span></span>
<span><span class="co">#&gt;        EST LowerCI UpperCI</span></span>
<span><span class="co">#&gt; apa 0.9442  0.9204  0.9657</span></span>
<span><span class="co">#&gt; ana 0.9489  0.9273  0.9681</span></span>
<span><span class="co">#&gt; opa 0.9467  0.9244  0.9667</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="precision-evaluation">Precision Evaluation<a class="anchor" aria-label="anchor" href="#precision-evaluation"></a>
</h3>
<p>This precision evaluation is not commonly used in IVD trials, but it
is necessary to include this process in end-users laboratories’ QC
procedure for verifying repeatability and within-laboratory precision. I
have wrapped the main and key functions from Roche’s <code>VCA</code>,
as well as the <code>mcr</code> package. It’s recommended to read the
details in <code><a href="../reference/anovaVCA.html">?anovaVCA</a></code> and <code><a href="../reference/VCAinference.html">?VCAinference</a></code>
functions or CLSI-EP05 to help understanding the outputs, such as
<code>CV%</code>.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anovaVCA.html">anovaVCA</a></span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="va">day</span> <span class="op">/</span> <span class="va">run</span>, <span class="va">glucose</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/VCAinference.html">VCAinference</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Inference from (V)ariance (C)omponent (A)nalysis</span></span>
<span><span class="co">#&gt; ------------------------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; &gt; VCA Result:</span></span>
<span><span class="co">#&gt; -------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Name    DF      SS    MS      VC      %Total  SD     CV[%] </span></span>
<span><span class="co">#&gt; 1 total   64.7773               12.9336 100     3.5963 1.4727</span></span>
<span><span class="co">#&gt; 2 day     19      415.8 21.8842 1.9586  15.1432 1.3995 0.5731</span></span>
<span><span class="co">#&gt; 3 day:run 20      281   14.05   3.075   23.7754 1.7536 0.7181</span></span>
<span><span class="co">#&gt; 4 error   40      316   7.9     7.9     61.0814 2.8107 1.151 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mean: 244.2 (N = 80) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Experimental Design: balanced  |  Method: ANOVA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; &gt; VC:</span></span>
<span><span class="co">#&gt; -----</span></span>
<span><span class="co">#&gt;         Estimate CI LCL  CI UCL One-Sided LCL One-Sided UCL</span></span>
<span><span class="co">#&gt; total    12.9336 9.4224 18.8614        9.9071       17.7278</span></span>
<span><span class="co">#&gt; day       1.9586                                           </span></span>
<span><span class="co">#&gt; day:run   3.0750                                           </span></span>
<span><span class="co">#&gt; error     7.9000 5.3251 12.9333        5.6673       11.9203</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; &gt; SD:</span></span>
<span><span class="co">#&gt; -----</span></span>
<span><span class="co">#&gt;         Estimate CI LCL CI UCL One-Sided LCL One-Sided UCL</span></span>
<span><span class="co">#&gt; total     3.5963 3.0696 4.3430        3.1476        4.2104</span></span>
<span><span class="co">#&gt; day       1.3995                                          </span></span>
<span><span class="co">#&gt; day:run   1.7536                                          </span></span>
<span><span class="co">#&gt; error     2.8107 2.3076 3.5963        2.3806        3.4526</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; &gt; CV[%]:</span></span>
<span><span class="co">#&gt; --------</span></span>
<span><span class="co">#&gt;         Estimate CI LCL CI UCL One-Sided LCL One-Sided UCL</span></span>
<span><span class="co">#&gt; total     1.4727  1.257 1.7785        1.2889        1.7242</span></span>
<span><span class="co">#&gt; day       0.5731                                          </span></span>
<span><span class="co">#&gt; day:run   0.7181                                          </span></span>
<span><span class="co">#&gt; error     1.1510  0.945 1.4727        0.9749        1.4138</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 95% Confidence Level  </span></span>
<span><span class="co">#&gt; SAS PROC MIXED method used for computing CIs</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="common-visualizations">Common Visualizations<a class="anchor" aria-label="anchor" href="#common-visualizations"></a>
</h2>
<p>In term of the visualizations of IVD trials, two common plots will be
presented in the clinical reports, Bland-Altman plot and Regression
plot. You don’t use two different functions to draw plots, both of them
have been included in <code><a href="../reference/autoplot.html">autoplot()</a></code> function. So these plots
can be obtained by just call <code><a href="../reference/autoplot.html">autoplot()</a></code> to an object.</p>
<div class="section level3">
<h3 id="bland-altman-plot">Bland-Altman plot<a class="anchor" aria-label="anchor" href="#bland-altman-plot"></a>
</h3>
<p>To generate the Bland-Altman plot, you should create the object from
<code><a href="../reference/blandAltman.html">blandAltman()</a></code> function and then call <code>autoplot</code>
straightforward where you can choose which Bland-Altman type do you
require, ‘absolute’ or ‘relative’.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/blandAltman.html">blandAltman</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">platelet</span><span class="op">$</span><span class="va">Comparative</span>, y <span class="op">=</span> <span class="va">platelet</span><span class="op">$</span><span class="va">Candidate</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Absolute difference plot</span></span>
<span><span class="fu"><a href="../reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">object</span>, type <span class="op">=</span> <span class="st">"absolute"</span><span class="op">)</span></span></code></pre></div>
<p><img src="mcradds_files/figure-html/unnamed-chunk-31-1.png" width="700"></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Relative difference plot</span></span>
<span><span class="fu"><a href="../reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">object</span>, type <span class="op">=</span> <span class="st">"relative"</span><span class="op">)</span></span></code></pre></div>
<p><img src="mcradds_files/figure-html/unnamed-chunk-31-2.png" width="700"></p>
<p>Add more drawing arguments if you would like to adjust the format.
More detailed arguments can be found in <code><a href="../reference/autoplot.html">?autoplot</a></code>.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/autoplot.html">autoplot</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"absolute"</span>,</span>
<span>  jitter <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  fill <span class="op">=</span> <span class="st">"lightblue"</span>,</span>
<span>  color <span class="op">=</span> <span class="st">"grey"</span>,</span>
<span>  size <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  ref.line.params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span>,</span>
<span>  loa.line.params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span>,</span>
<span>  label.digits <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  label.params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"grey"</span>, size <span class="op">=</span> <span class="fl">3</span>, fontface <span class="op">=</span> <span class="st">"italic"</span><span class="op">)</span>,</span>
<span>  x.nbreak <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  main.title <span class="op">=</span> <span class="st">"Bland-Altman Plot"</span>,</span>
<span>  x.title <span class="op">=</span> <span class="st">"Mean of Test and Reference Methods"</span>,</span>
<span>  y.title <span class="op">=</span> <span class="st">"Reference - Test"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="mcradds_files/figure-html/unnamed-chunk-32-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="regression-plot">Regression plot<a class="anchor" aria-label="anchor" href="#regression-plot"></a>
</h3>
<p>To generate the regression plot, you should create the object from
<code>mcreg()</code> function and then call <code>autoplot</code>
straightforward.</p>
<p>Please to be noted that the <code>mcr</code> package is not available
in CRAN, so the <code>mcreg</code> or <code>mcreg2</code> function can
not be used temporarily.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">mcreg2</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">platelet</span><span class="op">$</span><span class="va">Comparative</span>, y <span class="op">=</span> <span class="va">platelet</span><span class="op">$</span><span class="va">Candidate</span>,</span>
<span>  method.reg <span class="op">=</span> <span class="st">"PaBa"</span>, method.ci <span class="op">=</span> <span class="st">"bootstrap"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<p>More arguments can be used as shown below.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/autoplot.html">autoplot</a></span><span class="op">(</span></span>
<span>  <span class="va">fit</span>,</span>
<span>  identity.params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"blue"</span>, linetype <span class="op">=</span> <span class="st">"solid"</span><span class="op">)</span>,</span>
<span>  reg.params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="st">"solid"</span><span class="op">)</span>,</span>
<span>  equal.axis <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  legend.title <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  legend.digits <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  x.title <span class="op">=</span> <span class="st">"Reference"</span>,</span>
<span>  y.title <span class="op">=</span> <span class="st">"Test"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>In summary, <code>mcradds</code> contains multiple functions and
methods for internal statistical analyses or QC procedure in IVD trials.
The design of the package aims to expand the analysis scope of the
<code>mcr</code> package , and give users a lot of flexibility in
meeting their analysis needs. Given this package has not been validated
by the GCP process, it’s not recommended to use this in regulatory
submissions. However it can give the assist for you with the
supplementary analysis needs from the regulatory.</p>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<p>Here is the output of <code><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo()</a></code> on the system.</p>
<pre><code><span><span class="co">#&gt; R version 4.3.1 (2023-06-16)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.3 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices datasets  utils     methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] mcradds_1.0.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] gld_2.6.6           gtable_0.3.4        xfun_0.40          </span></span>
<span><span class="co">#&gt;  [4] bslib_0.5.1         ggplot2_3.4.3       lattice_0.21-8     </span></span>
<span><span class="co">#&gt;  [7] numDeriv_2016.8-1.1 vctrs_0.6.3         tools_4.3.1        </span></span>
<span><span class="co">#&gt; [10] generics_0.1.3      tibble_3.2.1        proxy_0.4-27       </span></span>
<span><span class="co">#&gt; [13] fansi_1.0.4         pkgconfig_2.0.3     Matrix_1.5-4.1     </span></span>
<span><span class="co">#&gt; [16] data.table_1.14.8   checkmate_2.2.0     desc_1.4.2         </span></span>
<span><span class="co">#&gt; [19] readxl_1.4.3        lifecycle_1.0.3     rootSolve_1.8.2.4  </span></span>
<span><span class="co">#&gt; [22] farver_2.1.1        compiler_4.3.1      stringr_1.5.0      </span></span>
<span><span class="co">#&gt; [25] textshaping_0.3.6   Exact_3.2           munsell_0.5.0      </span></span>
<span><span class="co">#&gt; [28] htmltools_0.5.6     DescTools_0.99.50   class_7.3-22       </span></span>
<span><span class="co">#&gt; [31] sass_0.4.7          yaml_2.3.7          nloptr_2.0.3       </span></span>
<span><span class="co">#&gt; [34] pillar_1.9.0        pkgdown_2.0.7       jquerylib_0.1.4    </span></span>
<span><span class="co">#&gt; [37] MASS_7.3-60         cachem_1.0.8        boot_1.3-28.1      </span></span>
<span><span class="co">#&gt; [40] nlme_3.1-162        tidyselect_1.2.0    digest_0.6.33      </span></span>
<span><span class="co">#&gt; [43] mvtnorm_1.2-3       stringi_1.7.12      dplyr_1.1.3        </span></span>
<span><span class="co">#&gt; [46] purrr_1.0.2         labeling_0.4.3      splines_4.3.1      </span></span>
<span><span class="co">#&gt; [49] rprojroot_2.0.3     fastmap_1.1.1       grid_4.3.1         </span></span>
<span><span class="co">#&gt; [52] colorspace_2.1-0    lmom_3.0            expm_0.999-7       </span></span>
<span><span class="co">#&gt; [55] cli_3.6.1           magrittr_2.0.3      utf8_1.2.3         </span></span>
<span><span class="co">#&gt; [58] VCA_1.4.5           e1071_1.7-13        withr_2.5.0        </span></span>
<span><span class="co">#&gt; [61] scales_1.2.1        backports_1.4.1     rmarkdown_2.25     </span></span>
<span><span class="co">#&gt; [64] httr_1.4.7          lme4_1.1-34         cellranger_1.1.0   </span></span>
<span><span class="co">#&gt; [67] ragg_1.2.5          memoise_2.0.1       evaluate_0.21      </span></span>
<span><span class="co">#&gt; [70] knitr_1.44          rlang_1.1.1         Rcpp_1.0.11        </span></span>
<span><span class="co">#&gt; [73] glue_1.6.2          renv_0.15.5         pROC_1.18.4        </span></span>
<span><span class="co">#&gt; [76] minqa_1.2.6         rstudioapi_0.15.0   jsonlite_1.8.7     </span></span>
<span><span class="co">#&gt; [79] plyr_1.8.8          R6_2.5.1            systemfonts_1.0.4  </span></span>
<span><span class="co">#&gt; [82] fs_1.6.3</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Kai Gu.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
